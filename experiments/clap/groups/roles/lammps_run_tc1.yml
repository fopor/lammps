---
- name: Running Test Case 1
  hosts: all[0]
  gather_facts: yes
  tasks:
  - name: Run simulation
    shell: |
      export test_case="TC-1" # chain scaled
      export cluster_cfg="{{ cfgalias }}"
      export curr_date=$(date -Iminutes)
      export experiment_dir="/efs/experimental_results/$test_case/$cluster_cfg/$curr_date"
      mkdir -p $experiment_dir
      { time /efs/lammps/experiments/mpich/bin/mpirun -hostfile ~/hosts /efs/lammps/build/lmp -in /efs/lammps/build/in.chain.scaled  > $experiment_dir/lmp.out 2>&1; } > $experiment_dir/time.out 2>&1
      

    args:
      chdir: "/efs/lammps/build/"